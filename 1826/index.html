<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Fine-tuning CodeLlama-7B for Fortran Code Generation</title>
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/5.3.3/zephyr/bootstrap.min.css"
      integrity="sha512-CWXb9sx63+REyEBV/cte+dE1hSsYpJifb57KkqAXjsN3gZQt6phZt7e5RhgZrUbaNfCdtdpcqDZtuTEB+D3q2Q=="
      crossorigin="anonymous"
      referrerpolicy="no-referrer" />
    <link
      rel="stylesheet"
      href="https://cdn.jsdelivr.net/gh/highlightjs/cdn-release@11.9.0/build/styles/atom-one-dark.min.css" />
    <link
      rel="stylesheet"
      href="https://unpkg.com/highlightjs-copy/dist/highlightjs-copy.min.css" />
    <script src="https://cdn.jsdelivr.net/gh/highlightjs/cdn-release@11.9.0/build/highlight.min.js"></script>
    <script src="https://cdn.jsdelivr.net/gh/highlightjs/cdn-release@11.9.0/build/languages/fortran.min.js"></script>
    <script src="https://cdn.jsdelivr.net/gh/highlightjs/cdn-release@11.9.0/build/languages/python.min.js"></script>
    <script src="https://cdn.jsdelivr.net/gh/highlightjs/cdn-release@11.9.0/build/languages/cpp.min.js"></script>
    <script src="https://unpkg.com/highlightjs-copy/dist/highlightjs-copy.min.js"></script>
    <script
      src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.min.js"
      integrity="sha384-BBtl+eGJRgqQAUMxJ7pMwbEyER4l1g+O15P+16Ep7Q9Q+zqX6gSbd85u4mG4QzX+"
      crossorigin="anonymous"></script>
  </head>
  <body>
    
<div class="container">
  <div class="row">
    <div class="col d-flex justify-content-between align-items-center">
      <h2>Faulty Sensor</h2>
      <div>
        <a href="/fortran-llm/" class="btn btn-outline-primary me-2">
          üè†
        </a>
        <a
          href="/fortran-llm/1822/"
          class="btn btn-outline-secondary me-2">
          ‚¨ÖÔ∏è
        </a>
        <a
          href="/fortran-llm/1827/"
          class="btn btn-outline-secondary">
          ‚û°Ô∏è
        </a>
      </div>
    </div>
  </div>

  <div class="row">
    <div class="col">
      <div class="leetcode-problem-content card">
        <div class="card-body">
          <p>An experiment is being conducted in a lab. To ensure accuracy, there are <strong>two</strong> sensors collecting data simultaneously. You are given two arrays <code>sensor1</code> and <code>sensor2</code>, where <code>sensor1[i]</code> and <code>sensor2[i]</code> are the <code>ith</code> data points collected by the two sensors.</p>
<p>However, this type of sensor has a chance of being defective, which causes <strong>exactly one</strong> data point to be dropped. After the data is dropped, all the data points to the <strong>right</strong> of the dropped data are <strong>shifted</strong> one place to the left, and the last data point is replaced with some <strong>random value</strong>. It is guaranteed that this random value will <strong>not</strong> be equal to the dropped value.</p>
<ul>
<li>For example, if the correct data is <code>[1,2,**3**,4,5]</code> and <code>3</code> is dropped, the sensor could return <code>[1,2,4,5,**7**]</code> (the last position can be <strong>any</strong> value, not just <code>7</code>).</li>
</ul>
<p>We know that there is a defect in <strong>at most one</strong> of the sensors. Return <em>the sensor number (</em><code>1</code> <em>or</em> <code>2</code><em>) with the defect. If there is <strong>no defect</strong> in either sensor or if it is <strong>impossible</strong> to determine the defective sensor, return</em> <code>-1</code><em>.</em></p>
<p><strong>Example 1:</strong></p>
<p><strong>Input:</strong> sensor1 = [2,3,4,5], sensor2 = [2,1,3,4]
<strong>Output:</strong> 1
<strong>Explanation:</strong> Sensor 2 has the correct values.
The second data point from sensor 2 is dropped, and the last value of sensor 1 is replaced by a 5.</p>
<p><strong>Example 2:</strong></p>
<p><strong>Input:</strong> sensor1 = [2,2,2,2,2], sensor2 = [2,2,2,2,5]
<strong>Output:</strong> -1
<strong>Explanation:</strong> It is impossible to determine which sensor has a defect.
Dropping the last value for either sensor could produce the output for the other sensor.</p>
<p><strong>Example 3:</strong></p>
<p><strong>Input:</strong> sensor1 = [2,3,2,2,3,2], sensor2 = [2,3,2,3,2,7]
<strong>Output:</strong> 2
<strong>Explanation:</strong> Sensor 1 has the correct values.
The fourth data point from sensor 1 is dropped, and the last value of sensor 1 is replaced by a 7.</p>
<p><strong>Constraints:</strong></p>
<ul>
<li><code>sensor1.length == sensor2.length</code></li>
<li><code>1 &lt;= sensor1.length &lt;= 100</code></li>
<li><code>1 &lt;= sensor1[i], sensor2[i] &lt;= 100</code></li>
</ul>
          <hr />
          <span class="fst-italic">
            Note: This problem is from
            <a
              href="https://leetcode.com/problems/faulty-sensor/description/">LeetCode</a>.
          </span>
        </div>
      </div>
      <style>
        .leetcode-problem-content {
          max-height: 200px;
          overflow-y: auto;
        }
      </style>
    </div>
  </div>
  <div class="row">
    <div class="col-md-6">
      <ul class="nav nav-underline mb-2" id="myTab" role="tablist">
        <li class="nav-item" role="presentation">
          <button
            class="nav-link active"
            id="our-model-tab"
            data-bs-toggle="tab"
            data-bs-target="#our-model-tab-pane"
            type="button"
            role="tab"
            aria-controls="our-model-tab-pane"
            aria-selected="true">
            ü¶æ Our model
          </button>
        </li>
      </ul>
      <div class="tab-content" id="myTabContent">
        <div
          class="tab-pane fade show active"
          id="our-model-tab-pane"
          role="tabpanel"
          aria-labelledby="our-model-tab"
          tabindex="0">
          <div class="row mb-2">
            <div class="col">
              <div
                class="card border-danger"
                style="border-width: 2px">
                <div class="card-body">
                  <span class="font-emoji">
                    ‚ùå
                  </span>
                  <strong>Compiled</strong>
                </div>
              </div>
            </div>

            <div class="col">
              <div
                class="card border-danger"
                style="border-width: 2px">
                <div class="card-body">
                  <span class="font_emoji">
                    ‚ùå
                  </span>
                  <strong>Executed</strong>
                </div>
              </div>
            </div>

            <div class="col">
              <div
                class="card border-danger"
                style="border-width: 2px">
                <div class="card-body">
                  <span class="font-emoji">
                    ‚ùå
                  </span>
                  <strong>Correct</strong>
                </div>
              </div>
            </div>
          </div>
          <pre><code class="language-fortran model-code">program main
    implicit none

    integer :: i, j, k
    integer, parameter :: n = 5
    integer, dimension(n) :: sensor1, sensor2
    integer :: result

    ! Example 1
    sensor1 = [2, 3, 4, 5]
    sensor2 = [2, 1, 3, 4]
    write(*,*) 'Example 1:'
    write(*,*) 'Sensor 1:', sensor1
    write(*,*) 'Sensor 2:', sensor2
    result = solve(sensor1, sensor2)
    write(*,*) 'Result: ', result

    ! Example 2
    sensor1 = [2, 2, 2, 2, 2]
    sensor2 = [2, 2, 2, 2, 5]
    write(*,*) 'Example 2:'
    write(*,*) 'Sensor 1:', sensor1
    write(*,*) 'Sensor 2:', sensor2
    result = solve(sensor1, sensor2)
    write(*,*) 'Result: ', result

    ! Example 3
    sensor1 = [2, 3, 2, 2, 3, 2]
    sensor2 = [2, 3, 2, 3, 2, 7]
    write(*,*) 'Example 3:'
    write(*,*) 'Sensor 1:', sensor1
    write(*,*) 'Sensor 2:', sensor2
    result = solve(sensor1, sensor2)
    write(*,*) 'Result: ', result

contains

    function solve(sensor1, sensor2) result(result)
        implicit none
        integer, intent(in) :: sensor1(:), sensor2(:)
        integer :: result

        do i = 1, size(sensor1)
            if (sensor1(i) /= sensor2(i)) then
                exit
            end if
        end do

        if (i > size(sensor1)) then
            result = -1
        else
            result = mod(i, 2) + 1
        end if

    end function solve

end program main</code></pre>

           
          <div class="alert alert-danger" role="alert">
            <strong>stderr</strong>
            <pre>temp.f95:10:4:

   10 |     sensor1 = [2, 3, 4, 5]
      |    1
Error: Different shape for array assignment at (1) on dimension 1 (5 and 4)
temp.f95:11:4:

   11 |     sensor2 = [2, 1, 3, 4]
      |    1
Error: Different shape for array assignment at (1) on dimension 1 (5 and 4)
temp.f95:28:4:

   28 |     sensor1 = [2, 3, 2, 2, 3, 2]
      |    1
Error: Different shape for array assignment at (1) on dimension 1 (5 and 6)
temp.f95:29:4:

   29 |     sensor2 = [2, 3, 2, 3, 2, 7]
      |    1
Error: Different shape for array assignment at (1) on dimension 1 (5 and 6)
</pre>
          </div>
          
        </div>
      </div>
    </div>
    <div class="col-md-6">
      <ul class="nav nav-underline mb-2" id="myTab" role="tablist">
        <li class="nav-item" role="presentation">
          <button
            class="nav-link active"
            id="codellama-tab"
            data-bs-toggle="tab"
            data-bs-target="#codellama-tab-pane"
            type="button"
            role="tab"
            aria-controls="codellama-tab-pane"
            aria-selected="true">
            ü¶ô CodeLlama-7B
          </button>
        </li>
        <li class="nav-item" role="presentation">
          <button
            class="nav-link"
            id="python-tab"
            data-bs-toggle="tab"
            data-bs-target="#python-tab-pane"
            type="button"
            role="tab"
            aria-controls="python-tab-pane"
            aria-selected="false">
            üêç Python
          </button>
        </li>
        <li class="nav-item" role="presentation">
          <button
            class="nav-link"
            id="cpp-tab"
            data-bs-toggle="tab"
            data-bs-target="#cpp-tab-pane"
            type="button"
            role="tab"
            aria-controls="cpp-tab-pane"
            aria-selected="false">
            ü§† C++
          </button>
        </li>
      </ul>
      <div class="tab-content" id="myTabContent">
        <div
          class="tab-pane fade show active"
          id="codellama-tab-pane"
          role="tabpanel"
          aria-labelledby="codellama-tab"
          tabindex="0">
          <div class="row mb-2">
            <div class="col">
              <div
                class="card border-danger"
                style="border-width: 2px">
                <div class="card-body">
                  <span class="font-emoji">
                    ‚ùå
                  </span>
                  <strong>Compiled</strong>
                </div>
              </div>
            </div>

            <div class="col">
              <div
                class="card border-danger"
                style="border-width: 2px">
                <div class="card-body">
                  <span class="font-emoji">
                    ‚ùå
                  </span>
                  <strong>Executed</strong>
                </div>
              </div>
            </div>

            <div class="col">
              <div
                class="card border-danger"
                style="border-width: 2px">
                <div class="card-body">
                  <span class="font-emoji">
                    ‚ùå
                  </span>
                  <strong>Correct</strong>
                </div>
              </div>
            </div>
          </div>
          <pre><code class="language-fortran model-code">module main

implicit none

integer, parameter :: dp = selected_real_kind(15, 307)

integer :: i, j, k, l, m, n
integer :: sensor1(100), sensor2(100)
integer :: sensor_with_defect

! Example 1
sensor1 = [2,3,4,5]
sensor2 = [2,1,3,4]

! Example 2
!sensor1 = [2,2,2,2,2]
!sensor2 = [2,2,2,2,5]

! Example 3
!sensor1 = [2,3,2,2,3,2]
!sensor2 = [2,3,2,3,2,7]

! Initialize the sensor with the defect
sensor_with_defect = -1

! Check if the sensors are equal
do i = 1, size(sensor1)
    if (sensor1(i) /= sensor2(i)) then
        sensor_with_defect = i
        exit
    end if
end do

! Print the result
if (sensor_with_defect == -1) then
    print *, "No defect in either sensor"
else
    print *, "Sensor with defect: ", sensor_with_defect
end if

end module
</code></pre>
           
          <div class="alert alert-danger" role="alert">
            <strong>stderr</strong>
            <pre>temp.f95:12:19:

   12 | sensor1 = [2,3,4,5]
      |                   1
Error: Unexpected assignment statement in MODULE at (1)
temp.f95:13:19:

   13 | sensor2 = [2,1,3,4]
      |                   1
Error: Unexpected assignment statement in MODULE at (1)
temp.f95:24:23:

   24 | sensor_with_defect = -1
      |                       1
Error: Unexpected assignment statement in MODULE at (1)
temp.f95:27:23:

   27 | do i = 1, size(sensor1)
      |                       1
Error: Unexpected DO statement in MODULE at (1)
temp.f95:28:38:

   28 |     if (sensor1(i) /= sensor2(i)) then
      |                                      1
Error: Unexpected block IF statement in MODULE at (1)
temp.f95:29:30:

   29 |         sensor_with_defect = i
      |                              1
Error: Unexpected assignment statement in MODULE at (1)
temp.f95:30:12:

   30 |         exit
      |            1
Error: EXIT statement at (1) is not within a construct
temp.f95:31:7:

   31 |     end if
      |       1
Error: Expecting END MODULE statement at (1)
temp.f95:32:3:

   32 | end do
      |   1
Error: Expecting END MODULE statement at (1)
temp.f95:35:34:

   35 | if (sensor_with_defect == -1) then
      |                                  1
Error: Unexpected block IF statement in MODULE at (1)
temp.f95:36:41:

   36 |     print *, "No defect in either sensor"
      |                                         1
Error: Unexpected WRITE statement in MODULE at (1)
temp.f95:37:4:

   37 | else
      |    1
Error: Unexpected ELSE statement in MODULE at (1)
temp.f95:38:55:

   38 |     print *, "Sensor with defect: ", sensor_with_defect
      |                                                       1
Error: Unexpected WRITE statement in MODULE at (1)
temp.f95:39:3:

   39 | end if
      |   1
Error: Expecting END MODULE statement at (1)
</pre>
          </div>
          
        </div>
        <div
          class="tab-pane fade"
          id="python-tab-pane"
          role="tabpanel"
          aria-labelledby="python-tab"
          tabindex="0">
          <alert class="alert alert-info d-flex">
            <strong>üåê Data from online sources</strong>
          </alert>
          <pre><code class="language-python">def maximizeXor(nums, queries):
    trie = {}
    nums.sort()

    new_queries = sorted([(x, m, i) for i, (x, m) in enumerate(queries)], key=lambda x: x[1])

    ans = [0] * len(queries)

    idx = 0
    for x, m, i in new_queries:
        while idx &lt; len(nums) and nums[idx] &lt;= m:
            t = nums[idx]
            idx += 1
            cur = trie
            for j in range(31, -1, -1):
                bit = (t &gt;&gt; j) &amp; 1
                cur = cur.setdefault(bit, {})
        cur = trie
        xor_value = 0
        for j in range(31, -1, -1):
            bit = (x &gt;&gt; j) &amp; 1
            if 1 ^ bit in cur:
                cur = cur[1 ^ bit]
                xor_value |= 1 &lt;&lt; j
            else:
                cur = cur[bit]
        ans[i] = xor_value if cur else -1

    return ans
</code></pre>
<pre><code>The algorithm uses a Trie data structure to store the binary representation of numbers in the nums array.
</code></pre>
<ol>
<li>First, sort the nums array in ascending order.</li>
<li>Create a new queries array, adding the index to each query, and sort according to the mi value.</li>
<li>Iterate through the sorted queries array and update Trie with nums elements that are less than or equal to mi. </li>
<li>For each x in the query, traverse the Trie and find the highest XOR value achievable.</li>
<li>If there are no Trie nodes, set the answer to -1 for that query.</li>
<li>Store the answer of each query in the ans array at the index originally present in the original query array.</li>
<li>Return the ans array containing the answer to all queries.</li>
</ol>
        </div>
        <div
          class="tab-pane fade"
          id="cpp-tab-pane"
          role="tabpanel"
          aria-labelledby="cpp-tab"
          tabindex="0">
          <alert class="alert alert-info d-flex">
            <strong>üåê Data from online sources</strong>
          </alert>
          <pre><code class="language-cpp">#include &lt;vector&gt;
#include &lt;algorithm&gt;
using namespace std;

vector&lt;int&gt; maximizeXor(vector&lt;int&gt;&amp; nums, vector&lt;vector&lt;int&gt;&gt;&amp; queries) {
    sort(nums.begin(), nums.end());
    for (int i = 0; i &lt; queries.size(); ++i) {
        queries[i].push_back(i);
    }
    sort(queries.begin(), queries.end(), [](vector&lt;int&gt; &amp;a, vector&lt;int&gt; &amp;b) {
        return a[1] &lt; b[1];
    });

    vector&lt;int&gt; ans(queries.size());
    int idx = 0, trie[200010][2] = {}, sum[200010] = {1}, cnt = 0;
    for (const auto &amp;q : queries) {
        int x = q[0], m = q[1], k = q[2], p = 0;
        while (idx &lt; nums.size() &amp;&amp; nums[idx] &lt;= m) {
            int cur = 0, t = nums[idx++];
            for (int i = 31; i &gt;= 0; --i) {
                int bit = ((t &gt;&gt; i) &amp; 1);
                if (!trie[cur][bit]) {
                    trie[cur][bit] = ++cnt;
                }
                cur = trie[cur][bit];
            }
            sum[cur]++;
        }
        if (!cnt) { 
            ans[k] = -1; 
            continue; 
        }
        int cur = 0, ans2 = 0;
        for (int i = 31; i &gt;= 0; --i) {
            int bit = ((x &gt;&gt; i) &amp; 1);
            if (trie[cur][bit ^ 1]) {
                cur = trie[cur][bit ^ 1];
                ans2 |= (1 &lt;&lt; i);
            } else {
                cur = trie[cur][bit];
            }
        }
        ans[k] = ans2;
    }
    return ans;
}
</code></pre>
<pre><code>The algorithm uses a Trie data structure to store the binary representation of numbers in the nums array.
</code></pre>
<ol>
<li>First, sort the nums array in ascending order.</li>
<li>Create a new queries array, adding the index to each query, and sort according to the mi value.</li>
<li>Iterate through the sorted queries array and update Trie with nums elements that are less than or equal to mi. </li>
<li>For each x in the query, traverse the Trie and find the highest XOR value achievable.</li>
<li>If there are no Trie nodes, set the answer to -1 for that query.</li>
<li>Store the answer of each query in the ans array at the index originally present in the original query array.</li>
<li>Return the ans array containing the answer to all queries.</li>
</ol>
        </div>
      </div>
      <style>
        .model-code {
          max-height: 600px;
          overflow-y: auto;
        }

        .font-emoji {
          font-family: emoji;
        }
      </style>
    </div>
  </div>
</div>
<script>
  hljs.addPlugin(new CopyButtonPlugin());
  hljs.highlightAll();
</script>

  </body>
</html>