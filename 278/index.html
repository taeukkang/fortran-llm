<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Fine-tuning CodeLlama-7B for Fortran Code Generation</title>
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/5.3.3/zephyr/bootstrap.min.css"
      integrity="sha512-CWXb9sx63+REyEBV/cte+dE1hSsYpJifb57KkqAXjsN3gZQt6phZt7e5RhgZrUbaNfCdtdpcqDZtuTEB+D3q2Q=="
      crossorigin="anonymous"
      referrerpolicy="no-referrer" />
    <link
      rel="stylesheet"
      href="https://cdn.jsdelivr.net/gh/highlightjs/cdn-release@11.9.0/build/styles/atom-one-dark.min.css" />
    <link
      rel="stylesheet"
      href="https://unpkg.com/highlightjs-copy/dist/highlightjs-copy.min.css" />
    <script src="https://cdn.jsdelivr.net/gh/highlightjs/cdn-release@11.9.0/build/highlight.min.js"></script>
    <script src="https://cdn.jsdelivr.net/gh/highlightjs/cdn-release@11.9.0/build/languages/fortran.min.js"></script>
    <script src="https://cdn.jsdelivr.net/gh/highlightjs/cdn-release@11.9.0/build/languages/python.min.js"></script>
    <script src="https://cdn.jsdelivr.net/gh/highlightjs/cdn-release@11.9.0/build/languages/cpp.min.js"></script>
    <script src="https://unpkg.com/highlightjs-copy/dist/highlightjs-copy.min.js"></script>
    <script
      src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.min.js"
      integrity="sha384-BBtl+eGJRgqQAUMxJ7pMwbEyER4l1g+O15P+16Ep7Q9Q+zqX6gSbd85u4mG4QzX+"
      crossorigin="anonymous"></script>
  </head>
  <body>
    
<div class="container">
  <div class="row">
    <div class="col d-flex justify-content-between align-items-center">
      <h2>First Bad Version</h2>
      <div>
        <a href="/" class="btn btn-outline-primary me-2">
          üè†
        </a>
        <a
          href="/270/"
          class="btn btn-outline-secondary me-2">
          ‚¨ÖÔ∏è
        </a>
        <a
          href="/283/"
          class="btn btn-outline-secondary">
          ‚û°Ô∏è
        </a>
      </div>
    </div>
  </div>

  <div class="row">
    <div class="col">
      <div class="leetcode-problem-content card">
        <div class="card-body">
          <p>You are a product manager and currently leading a team to develop a new product. Unfortunately, the latest version of your product fails the quality check. Since each version is developed based on the previous version, all the versions after a bad version are also bad.</p>
<p>Suppose you have <code>n</code> versions <code>[1, 2, ..., n]</code> and you want to find out the first bad one, which causes all the following ones to be bad.</p>
<p>You are given an API <code>bool isBadVersion(version)</code> which returns whether <code>version</code> is bad. Implement a function to find the first bad version. You should minimize the number of calls to the API.</p>
<p><strong>Example 1:</strong></p>
<p><strong>Input:</strong> n = 5, bad = 4
<strong>Output:</strong> 4
<strong>Explanation:</strong>
call isBadVersion(3) -&gt; false
call isBadVersion(5) -&gt; true
call isBadVersion(4) -&gt; true
Then 4 is the first bad version.</p>
<p><strong>Example 2:</strong></p>
<p><strong>Input:</strong> n = 1, bad = 1
<strong>Output:</strong> 1</p>
<p><strong>Constraints:</strong></p>
<ul>
<li><code>1 &lt;= bad &lt;= n &lt;= 231 - 1</code></li>
</ul>
          <hr />
          <span class="fst-italic">
            Note: This problem is from
            <a
              href="https://leetcode.com/problems/first-bad-version/description/">LeetCode</a>.
          </span>
        </div>
      </div>
      <style>
        .leetcode-problem-content {
          max-height: 200px;
          overflow-y: auto;
        }
      </style>
    </div>
  </div>
  <div class="row">
    <div class="col-md-6">
      <ul class="nav nav-underline mb-2" id="myTab" role="tablist">
        <li class="nav-item" role="presentation">
          <button
            class="nav-link active"
            id="our-model-tab"
            data-bs-toggle="tab"
            data-bs-target="#our-model-tab-pane"
            type="button"
            role="tab"
            aria-controls="our-model-tab-pane"
            aria-selected="true">
            ü¶æ Our model
          </button>
        </li>
      </ul>
      <div class="tab-content" id="myTabContent">
        <div
          class="tab-pane fade show active"
          id="our-model-tab-pane"
          role="tabpanel"
          aria-labelledby="our-model-tab"
          tabindex="0">
          <div class="row mb-2">
            <div class="col">
              <div
                class="card border-success"
                style="border-width: 2px">
                <div class="card-body">
                  <span class="font-emoji">
                    ‚úÖ
                  </span>
                  <strong>Compiled</strong>
                </div>
              </div>
            </div>

            <div class="col">
              <div
                class="card border-danger"
                style="border-width: 2px">
                <div class="card-body">
                  <span class="font_emoji">
                    ‚ùå
                  </span>
                  <strong>Executed</strong>
                </div>
              </div>
            </div>

            <div class="col">
              <div
                class="card border-danger"
                style="border-width: 2px">
                <div class="card-body">
                  <span class="font-emoji">
                    ‚ùå
                  </span>
                  <strong>Correct</strong>
                </div>
              </div>
            </div>
          </div>
          <pre><code class="language-fortran model-code">program main
    use, intrinsic :: iso_fortran_env, only : error_unit, DP => REAL64
    implicit none
    integer :: n, i, j
    logical :: bad
    real(kind=DP) :: x

    ! read input
    read (*, *) n

    ! solve problem
    do i = 1, n
        call isBadVersion(i, bad)
        if (bad) then
            write (unit=error_unit, fmt='(A, I0)') 'First bad version: ', i
            exit
        end if
    end do

contains

    subroutine isBadVersion(version, bad)
        implicit none
        integer, value :: version
        logical, intent(out) :: bad

        select case (version)
        case (1)
            bad = .false.
        case (2)
            bad = .true.
        case (3)
            bad = .false.
        case (4)
            bad = .true.
        case (5)
            bad = .true.
        case default
            bad = .false.
        end select
    end subroutine isBadVersion
end program main</code></pre>

           
          <div class="alert alert-danger" role="alert">
            <strong>stderr</strong>
            <pre>At line 9 of file temp.f95 (unit = 5, file = 'stdin')
Fortran runtime error: End of file

Error termination. Backtrace:
#0  0x7e0f7c3c7960 in ???
#1  0x7e0f7c3c84d9 in ???
#2  0x7e0f7c61c17b in ???
#3  0x7e0f7c615684 in ???
#4  0x7e0f7c6162aa in ???
#5  0x5819373092a3 in MAIN__
#6  0x5819373093df in main
</pre>
          </div>
          
        </div>
      </div>
    </div>
    <div class="col-md-6">
      <ul class="nav nav-underline mb-2" id="myTab" role="tablist">
        <li class="nav-item" role="presentation">
          <button
            class="nav-link active"
            id="codellama-tab"
            data-bs-toggle="tab"
            data-bs-target="#codellama-tab-pane"
            type="button"
            role="tab"
            aria-controls="codellama-tab-pane"
            aria-selected="true">
            ü¶ô CodeLlama-7B
          </button>
        </li>
        <li class="nav-item" role="presentation">
          <button
            class="nav-link"
            id="python-tab"
            data-bs-toggle="tab"
            data-bs-target="#python-tab-pane"
            type="button"
            role="tab"
            aria-controls="python-tab-pane"
            aria-selected="false">
            üêç Python
          </button>
        </li>
        <li class="nav-item" role="presentation">
          <button
            class="nav-link"
            id="cpp-tab"
            data-bs-toggle="tab"
            data-bs-target="#cpp-tab-pane"
            type="button"
            role="tab"
            aria-controls="cpp-tab-pane"
            aria-selected="false">
            ü§† C++
          </button>
        </li>
      </ul>
      <div class="tab-content" id="myTabContent">
        <div
          class="tab-pane fade show active"
          id="codellama-tab-pane"
          role="tabpanel"
          aria-labelledby="codellama-tab"
          tabindex="0">
          <div class="row mb-2">
            <div class="col">
              <div
                class="card border-danger"
                style="border-width: 2px">
                <div class="card-body">
                  <span class="font-emoji">
                    ‚ùå
                  </span>
                  <strong>Compiled</strong>
                </div>
              </div>
            </div>

            <div class="col">
              <div
                class="card border-danger"
                style="border-width: 2px">
                <div class="card-body">
                  <span class="font-emoji">
                    ‚ùå
                  </span>
                  <strong>Executed</strong>
                </div>
              </div>
            </div>

            <div class="col">
              <div
                class="card border-danger"
                style="border-width: 2px">
                <div class="card-body">
                  <span class="font-emoji">
                    ‚ùå
                  </span>
                  <strong>Correct</strong>
                </div>
              </div>
            </div>
          </div>
          <pre><code class="language-fortran model-code">module isBadVersion

    implicit none

    interface
        function isBadVersion(version) result(is_bad)
            integer, intent(in) :: version
            logical :: is_bad
        end function isBadVersion
    end interface

contains

    function findFirstBadVersion(n) result(first_bad)
        integer, intent(in) :: n
        integer :: i
        logical :: is_bad

        first_bad = -1

        do i = 1, n
            is_bad = isBadVersion(i)
            if (is_bad) then
                first_bad = i
                exit
            end if
        end do
    end function findFirstBadVersion

end module isBadVersion

program main
    use isBadVersion
    implicit none

    integer :: n, first_bad

    ! Example 1
    n = 5
    first_bad = findFirstBadVersion(n)
    if (first_bad /= 4) then
        write (*,*) "Test 1 failed"
        stop 1
    end if

    ! Example 2
    n = 1
    first_bad = findFirstBadVersion(n)
    if (first_bad /= 1) then
        write (*,*) "Test 2 failed"
        stop 1
    end if

    ! Example 3
    n = 2
    first_bad = findFirstBadVersion(n)
    if (first_bad /= -1) then
        write (*,*) "Test 3 failed"
        stop 1
    end if

    ! Example 4
    n = 3
    first_bad = findFirstBadVersion(n)
    if (first_bad /= -1) then
        write (*,*) "Test 4 failed"
        stop 1
    end if

    ! Example 5
    n = 4
    first_bad = findFirstBadVersion(n)
    if (first_bad /= -1) then
        write (*,*) "Test 5 failed"
        stop 1
    end if

    ! Example 6
    n = 5
    first_bad = findFirstBadVersion(n)
    if (first_bad /= 4) then
        write (*,*) "Test 6 failed"
        stop 1
    end if

    ! Example 7
    n = 6
    first_bad = findFirstBadVersion(n)
    if (first_bad /= 4) then
        write (*,*) "Test 7 failed"
        stop 1
    end if

    ! Example 8
    n = 7
    first_bad = findFirstBadVersion(n)
    if (first_bad /= 4) then
        write (*,*) "Test 8 failed"
        stop 1
    end if

    ! Example 9
    n = 8
    first_bad = findFirstBadVersion(n)
    if (first_bad /= 4) then
        write (*,*) "Test 9 failed"
        stop 1
    end if

    ! Example 10
    n = 9
    first_bad = findFirstBadVersion(n)
    if (first_bad /= 4) then
        write (*,*) "Test 10 failed"
        stop 1
    end if

    write (*,*) "All tests passed"

end program main
</code></pre>
           
          <div class="alert alert-danger" role="alert">
            <strong>stderr</strong>
            <pre>temp.f95:6:29:

    6 |         function isBadVersion(version) result(is_bad)
      |                             1
Error: MODULE attribute of ‚Äòisbadversion‚Äô conflicts with PROCEDURE attribute at (1)
temp.f95:7:42:

    7 |             integer, intent(in) :: version
      |                                          1
Error: Unexpected data declaration statement in INTERFACE block at (1)
temp.f95:8:29:

    8 |             logical :: is_bad
      |                             1
Error: Unexpected data declaration statement in INTERFACE block at (1)
temp.f95:9:11:

    9 |         end function isBadVersion
      |           1
Error: Expecting END INTERFACE statement at (1)
temp.f95:14:53:

   14 |     function findFirstBadVersion(n) result(first_bad)
      |                                                     1
Error: Function result ‚Äòfirst_bad‚Äô at (1) has no IMPLICIT type
temp.f95:22:34:

   22 |             is_bad = isBadVersion(i)
      |                                  1
Error: Symbol at (1) is not appropriate for an expression
temp.f95:33:9:

   33 |     use isBadVersion
      |         1
Fatal Error: Cannot open module file ‚Äòisbadversion.mod‚Äô for reading at (1): No such file or directory
compilation terminated.
</pre>
          </div>
          
        </div>
        <div
          class="tab-pane fade"
          id="python-tab-pane"
          role="tabpanel"
          aria-labelledby="python-tab"
          tabindex="0">
          <alert class="alert alert-info d-flex">
            <strong>üåê Data from online sources</strong>
          </alert>
          <pre><code class="language-python">def first_bad_version(n):
    left, right = 1, n
    while left &lt; right:
        mid = left + (right - left) // 2
        if is_bad_version(mid):
            right = mid
        else:
            left = mid + 1
    return left
</code></pre>
<pre><code>The algorithm used here is a binary search approach which starts with the range from the first to the last version. In each iteration, it takes the middle point and checks if it's a bad version by calling `isBadVersion()` API.
</code></pre>
<p>If the middle version is bad, this means that the first bad version is either the middle version or somewhere on the left side of the range. So, we update the right end of the range to the middle version.</p>
<p>If the middle version is not bad, the first bad version must be somewhere on the right side of the range. So, we update the left end of the range to the middle version + 1.</p>
<p>The loop will continue until the left and right pointers converge, indicating that we have found the first bad version. As a result, we return the value of the left pointer.</p>
<p>This algorithm has a complexity of O(log n), as it reduces the search range by half at each iteration hence minimizing the number of calls to the API.</p>
        </div>
        <div
          class="tab-pane fade"
          id="cpp-tab-pane"
          role="tabpanel"
          aria-labelledby="cpp-tab"
          tabindex="0">
          <alert class="alert alert-info d-flex">
            <strong>üåê Data from online sources</strong>
          </alert>
          <pre><code class="language-cpp">int firstBadVersion(int n) {
    int left = 1;
    int right = n;
    while (left &lt; right) {
        int mid = left + (right - left) / 2;
        if (isBadVersion(mid)) {
            right = mid;
        } else {
            left = mid + 1;
        }
    }
    return left;
}
</code></pre>
<pre><code>The algorithm used here is a binary search approach which starts with the range from the first to the last version. In each iteration, it takes the middle point and checks if it's a bad version by calling `isBadVersion()` API.
</code></pre>
<p>If the middle version is bad, this means that the first bad version is either the middle version or somewhere on the left side of the range. So, we update the right end of the range to the middle version.</p>
<p>If the middle version is not bad, the first bad version must be somewhere on the right side of the range. So, we update the left end of the range to the middle version + 1.</p>
<p>The loop will continue until the left and right pointers converge, indicating that we have found the first bad version. As a result, we return the value of the left pointer.</p>
<p>This algorithm has a complexity of O(log n), as it reduces the search range by half at each iteration hence minimizing the number of calls to the API.</p>
        </div>
      </div>
      <style>
        .model-code {
          max-height: 600px;
          overflow-y: auto;
        }

        .font-emoji {
          font-family: emoji;
        }
      </style>
    </div>
  </div>
</div>
<script>
  hljs.addPlugin(new CopyButtonPlugin());
  hljs.highlightAll();
</script>

  </body>
</html>